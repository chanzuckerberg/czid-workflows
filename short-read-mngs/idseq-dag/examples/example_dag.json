{
  "output_dir_s3": "s3://idseq-samples-prod/1/10/results",
  "nodes": {
    "fastqs": ["fastq1.gz", "fastq2.gz"],
    "star_out": ["unmapped1.fq", "unmapped2.fq"],
    "priceseq_out": ["priceseq1.fq", "priceseq2.fq"],
    "lzw_out": ["lzw1.fa", "lzw2.fa"],
    "cdhitdup_out": ["dedup1.fa", "dedup2.fa"],
    "bowtie_out": ["bowtie1.fa", "bowtie2.fa"],
    "gsnap_filter_out": ["gsnap_filtere1.fa", "gsnap_filtere2.fa"],
    "gsnap_out":  ["gsnap.m8"],
    "rapsearch_out":  ["rapsearch.m8"],
    "taxon_count_out": ["web_sample.json", "gsnap.filtered.m8", "rapsearch.filtered.m8"]
  },

  "steps": [
    {
      "in" : ["fastqs"], "out": "star_out", "class": "PipelineStepRunStar",
      "additional_files": {"star_genome": "s3://idseq-database/star_genome"},
      "additional_attributes": {"truncate_reads_to": 75000000}
    },
    {
      "in" : ["star_out"], "out": "priceseq_out", "class": "PipelineStepRunPriceSeq",
      "additional_files": {},
      "additional_attributes": {}
    },
    {
      "in" : ["priceseq_out"], "out": "lzw_out", "class": "PipelineStepRunLZW",
      "additional_files": {},
      "additional_attributes": {"threshold": 0.45}
    },
    {
      "in" : ["lzw_out"], "out": "cdhitdup_out", "class": "PipelineStepRunCDHitDup",
      "additional_files": {},
      "additional_attributes": {}
    },
    {
      "in" : ["cdhitdup_out"], "out": "bowtie_out", "class": "PipelineStepRunBowtie2",
      "additional_files": {"bowtie_genome": "s3://idseq-database/bowtie_genome"},
      "additional_attributes": {}
    },
    {
      "in" : ["bowtie_out"], "out": "gsnap_filter_out", "class": "PipelineStepRunGsnapFilter",
      "additional_files": {"gsnap_genome": "s3://idseq-database/gsnap_genome"},
      "additional_attributes": {"sub_sample_to": 1000000}
    },
    {
      "in" : ["gsnap_filter_out"], "out": "gsnap_out", "class": "PipelineStepRunGsnap",
      "additional_files": {},
      "additional_attributes": {"chunk_size": 10000, "cluster": "prod"}
    },
    {
      "in" : ["gsnap_filter_out"], "out": "rapsearch_out", "class": "PipelineStepRunRapsearch",
      "additional_files": {},
      "additional_attributes": {"chunk_size": 5000, "cluster": "prod"}
    },
    {
      "in" : ["gsnap_out", "rapsearch_out"], "out": "taxon_count_out",
      "class": "PipelineStepRunHitcalling",
      "additional_files": {},
      "additional_attributes": {}
    }
  ],
  "head_nodes": [["fastqs", "s3://idseq-samples-prod/1/10/fastqs"]]
}
